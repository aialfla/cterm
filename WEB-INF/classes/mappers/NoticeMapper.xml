<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="com.ezen.cterm.mapper.noticeMapper">

	<!-- !! Mapper 등록 후 꼭 DAO 주소 입력할 것 !! ex) "mapper namespace.id" -->
	
	<!-- 공지사항 글 조회 //select -->
	<select id="view" parameterType="int" resultType="NoticeVo">
		 select * from notice where nNO = #{ nNO } 
	</select>
	
	<!-- 공지사항 글 작성 //insert -->
	<insert id="write" parameterType="NoticeVo" useGeneratedKeys="true" keyProperty="nNO">
		 insert into notice ( nTitle, nNote, wdate, id ) 
		 values ( #{ nTitle }, #{ nNote }, now(), #{ id } )
	</insert>
	
	<!-- 공지사항 글 수정 //update -->
	<update id="modify" parameterType="NoticeVo">
		 update notice set nTitle = #{ nTitle }, nNote = #{ nNote }, wdate = now() where nNO = #{ nNO }
	</update>
	
	<!-- 공지사항 글 삭제 //delete-->
	<delete id="delete" parameterType="int">
		 delete from notice where nNO = #{ nNO } 
	</delete>
	<delete id="fdelete" parameterType="int">
		 delete from noticeAttach where nNO = #{ nNO } 
	</delete>
	
	<!-- 공지사항 등록 글 갯수 조회 //select -->
	<select id="count" resultType="int">
		 select count(*) from notice
	</select>
	
	<!-- 공지사항 목록 조회 //select -->
	<select id="list" parameterType="MemberSearchVo" resultType="map">
		select nNO, nTitle, nNote, (DATE_FORMAT(wdate,'%Y-%m-%d')) as wdate, id from notice ORDER BY UNIX_TIMESTAMP(wdate) desc limit #{ limitOffset }, #{ perPage }
	</select>
	
	<!-- 파일 등록 -->
	<insert id="fileAdd" parameterType="NoticeAttachVo">
		 insert into noticeAttach (newName, orgName, nNO)
		 values ( #{ newName }, #{ orgName }, #{ nNO } ) 
	</insert>
	
	<!-- 파일 삭제 -->
	<delete id="fileDelete" parameterType="String">
		 delete from noticeAttach where newName = #{ newName } 
	</delete>
	
	<!-- 파일 조회 -->
	<select id="Alist" parameterType="int" resultType="NoticeAttachVo">
		 select * from noticeAttach where nNO = #{ nNO } 
	</select>
	
</mapper>